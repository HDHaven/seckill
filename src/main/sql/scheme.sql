-- 数据库初始化脚本

-- 创建数据库
CREATE DATABASE DB_SECKILL;
-- 使用数据库
USE DB_SECKILL;
-- 创建秒杀库存表
CREATE TABLE TB_SECKILL (
	'SECKILL_ID' BIGINT NOT NULL AUTO_INCREMENT COMMENT '商品库存id',
	'NAME' VARCHAR(120) NOT NULL COMMENT '商品名称',
	'NUMBER' INT NOT NULL COMMENT '库存数量',
	'START_TIME' TIMESTAMP NOT NULL COMMENT '秒杀开始时间',
	'END_TIME' TIMESTAMP NOT NULL COMMENT '秒杀结束时间',
	'CREATE_TIME' TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
	PRIMARY KEY (SECKILL_ID),
	KEY IDX_START_TIME(START_TIME),	-- 创建索引，提升查询速度
	KEY IDX_END_TIME(END_TIME),
	KEY IDX_CREATE_TIME(CREATE_TIME)
)ENGINE=INNODB AUTO_INCREMENT=1000 DEFAULT CHARSET=UTF8 COMMENT='秒杀库存表'

-- 初始化数据
INSERT INTO 
	TB_SECKILL(NAME, NUMBER, START_TIME, END_TIME)
VALUES
	('1000元秒杀iPhone8', 100, '2017-09-01 00:00:00', '2017-09-02 00:00:00'),
	('500元秒杀ipad3', 200, '2017-09-01 00:00:00', '2017-09-02 00:00:00'),
	('300元秒杀小米5', 500, '2017-09-01 00:00:00', '2017-09-02 00:00:00'),
	('200元秒杀红米note3', 1000, '2017-09-01 00:00:00', '2017-09-02 00:00:00');
	
-- 秒杀成功明细表
-- 用户登录认证相关信息
CREATE TABLE TB_SUCCESS_KILLED (
	'SECKILL_ID' BIGINT NOT NULL COMMENT '秒杀商品ID',
	'USER_PHONE' BIGINT NOT NULL COMMENT '用户手机号',
	'STATE' TINYINT NOT NULL DEFAULT -1 COMMENT '状态表示：-1：无效	0：成功	1：已付款'
	'CREATE_TIME' TIMESTAMP NOT NULL COMMENT '创建时间',
	PRIMARY KEY(SECKILL_ID, USER_PHONE), /*联合主键*/
	KEY IDX_CREATE_TIME(CREATE_TIME)
)ENGINE=INNODB DEFAULT CHARSET=UTF8 COMMENT='秒杀成功明细表'


